(function(t){function e(e){for(var n,s,i=e[0],o=e[1],u=e[2],f=0,d=[];f<i.length;f++)s=i[f],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&d.push(r[s][0]),r[s]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n]);c&&c(e);while(d.length)d.shift()();return l.push.apply(l,u||[]),a()}function a(){for(var t,e=0;e<l.length;e++){for(var a=l[e],n=!0,i=1;i<a.length;i++){var o=a[i];0!==r[o]&&(n=!1)}n&&(l.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},r={app:0},l=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],o=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var c=o;l.push([1,"chunk-vendors"]),a()})({0:function(t,e){},1:function(t,e,a){t.exports=a("56d7")},2:function(t,e){},3:function(t,e){},"418c":function(t,e,a){},5316:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("email")],1)},l=[],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"sendEmail"},[a("el-steps",{attrs:{active:t.step,"align-center":""}},[a("el-step",{attrs:{title:"导入Excel数据"}},[a("i",{staticClass:"iconfont iconexcel",attrs:{slot:"icon"},slot:"icon"})]),a("el-step",{attrs:{title:"配置发送邮箱信息"}},[a("i",{staticClass:"iconfont iconQQyouxiang",attrs:{slot:"icon"},slot:"icon"})]),a("el-step",{attrs:{title:"开始发送",icon:"el-icon-s-promotion"}})],1),1===t.step?a("div",{staticClass:"main"},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"",accept:".xlsx",limit:1,"auto-upload":!1,"on-change":t.changFile}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或 "),a("em",[t._v("点击导入")])])]),a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",data:t.form.tableData}},[t.headerData.length>0?a("el-table-column",{attrs:{type:"index",width:"50"}}):t._e(),t._l(t.headerData,(function(t){return a("el-table-column",{key:t,attrs:{prop:t,label:t}})})),t.headerData.length>0?a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),t.form.tableData.splice(e.$index,1)}}},[t._v(" 移除 ")])]}}],null,!1,3085740015)}):t._e()],2)],1):t._e(),2===t.step?a("div",{staticClass:"main set"},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"发送邮件主题",prop:"subject"}},[a("el-input",{attrs:{size:"small",placeholder:"如工资条"},model:{value:t.form.subject,callback:function(e){t.$set(t.form,"subject",e)},expression:"form.subject"}})],1),a("el-form-item",{attrs:{label:"发送者QQ邮箱",prop:"user"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入发送者QQ邮箱"},model:{value:t.form.user,callback:function(e){t.$set(t.form,"user",e)},expression:"form.user"}})],1),a("el-form-item",{attrs:{label:"QQ邮箱授权码",prop:"pass"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入QQ邮箱授权码"},model:{value:t.form.pass,callback:function(e){t.$set(t.form,"pass",e)},expression:"form.pass"}}),a("a",{attrs:{target:"view_window",href:"https://jingyan.baidu.com/article/fedf0737af2b4035ac8977ea.html"}},[t._v("如何获取")])],1)],1)],1):t._e(),3===t.step?a("div",{staticClass:"main"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"发送邮件主题:"}},[t._v(t._s(t.form.subject))]),a("el-form-item",{attrs:{label:"发送者QQ邮箱:"}},[t._v(t._s(t.form.user))]),a("el-form-item",{attrs:{label:"QQ邮箱授权码:"}},[t._v(t._s(t.form.pass))]),a("el-form-item",{attrs:{label:"指定邮箱列:"}},[t._v(t._s(t.form.emailColumn))])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",data:t.form.tableData}},[t.headerData.length>0?a("el-table-column",{attrs:{type:"index",width:"50"}}):t._e(),t._l(t.headerData,(function(t){return a("el-table-column",{key:t,attrs:{prop:t,label:t}})})),a("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.status[e.row[t.form.emailColumn]]?a("el-tag",{attrs:{type:"success"}},[t._v("发送成功")]):t._e()]}}],null,!1,2383987774)})],2)],1):t._e(),a("div",{staticClass:"footer"},[1===t.step?a("el-dropdown",{staticStyle:{cursor:"pointer",margin:"0 10px"}},[a("span",{staticClass:"el-dropdown-link"},[t._v(" "+t._s(t.form.emailColumn||"请指定邮箱列")),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.headerData.length>0?t._l(t.headerData,(function(e){return a("el-dropdown-item",{key:e,nativeOn:{click:function(a){t.form.emailColumn=e}}},[t._v(t._s(e))])})):a("el-dropdown-item",[t._v("请先导入文件")])],2)],1):t._e(),1!==t.step?a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.step-=1}}},[t._v("上一步")]):t._e(),3!==t.step?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.next}},[t._v("下一步")]):t._e(),3===t.step?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.send}},[t._v("发送")]):t._e()],1)],1)},i=[],o=(a("b64b"),a("3835")),u=a("1146"),c=a.n(u),f=a("bc3a"),d=a.n(f),p={data:function(){var t=/^[1-9]\d{4,10}@qq\.com/,e=function(e,a,n){t.test(a)?n():n(new Error("QQ邮箱格式有误！"))};return{loading:!1,step:1,headerData:[],form:{subject:null,tableData:[],emailColumn:null,user:null,pass:null},status:{},rules:{user:[{required:!0,message:"请输入QQ邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],pass:[{required:!0,message:"请输入QQ邮箱授权码",trigger:"blur"}],subject:[{required:!0,message:"请输入发送邮件主题",trigger:"blur"}]}}},methods:{changFile:function(t){var e=new FileReader;e.onload=function(t){var e=c.a.read(t.target.result,{type:"binary"}),a=c.a.utils.sheet_to_json(e.Sheets[e.SheetNames[0]]);this.form.tableData=a;var n=Object(o["a"])(a,1),r=n[0];this.headerData=r?Object.keys(r):[]}.bind(this),e.readAsBinaryString(t.raw)},validOk:function(){if(0===this.form.tableData.length)return this.$message.warning("请导入文件或未检测到文件数据"),!1;if(!this.form.emailColumn)return this.$message.warning("请选择指定邮箱列"),!1;for(var t={},e=/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,a=0,n=this.form.tableData.length;a<n;a+=1){var r=this.form.tableData[a][this.form.emailColumn];if(!e.test(r))return this.$message.warning("第 "+(a+1)+" 行邮箱格式不正确"),!1;if(void 0!==t[r])return this.$message.warning("第 "+(a+1)+" 与第 "+t[r]+" 行邮箱重复"),!1;t[r]=a+1}return!0},next:function(){var t=this;1===this.step&&this.validOk()?this.step=2:2===this.step&&this.$refs.form.validate((function(e){if(!e)return!1;t.step=3}))},send:function(){var t=this;this.$confirm("确定发送邮件吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,t.status={},d.a.post("/send",{data:t.form}).then((function(e){t.status=e.data||{},t.loading=!1})).cath((function(){t.loading=!1}))})).catch((function(){}))}}},m=p,h=(a("c862"),a("2877")),b=Object(h["a"])(m,s,i,!1,null,"7624fbef",null),v=b.exports,g={data:function(){return{activeIndex:"1"}},components:{email:v}},_=g,w=(a("6c8d"),Object(h["a"])(_,r,l,!1,null,"b8ed5dbe",null)),y=w.exports,x=a("5c96"),j=a.n(x);a("0fae"),a("a342");n["default"].config.productionTip=!1,n["default"].use(j.a),new n["default"]({render:function(t){return t(y)}}).$mount("#app")},"6c8d":function(t,e,a){"use strict";var n=a("5316"),r=a.n(n);r.a},a342:function(t,e,a){},c862:function(t,e,a){"use strict";var n=a("418c"),r=a.n(n);r.a}});
//# sourceMappingURL=app.d26bf24d.js.map